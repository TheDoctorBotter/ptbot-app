# Supabase Edge Functions Configuration
# https://supabase.com/docs/guides/functions/config

# =============================================================================
# EDGE FUNCTION SETTINGS – ALL functions use verify_jwt = false
# =============================================================================
# Why every function is verify_jwt = false:
#
# Every auth-required function validates the JWT itself via
# supabase.auth.getUser(token).  When verify_jwt = true the Supabase gateway
# performs its own JWT check AND can modify the Authorization header (replacing
# the user JWT with a service-role token) before forwarding the request to the
# function.  The function's own getUser() call then receives the wrong token
# and returns 401 — even though the user is signed in with a valid JWT.
#
# Setting verify_jwt = false lets the original user JWT pass through untouched
# so every function's internal auth check always works correctly.

# calendar-availability: Public - anyone can view available slots
[functions.calendar-availability]
verify_jwt = false

# calendar-book: Public - supports booking with or without an account
[functions.calendar-book]
verify_jwt = false

# calendar-appointments: Validates JWT internally via supabase.auth.getUser()
[functions.calendar-appointments]
verify_jwt = false

# openai-proxy: Validates JWT internally via supabase.auth.getUser()
[functions.openai-proxy]
verify_jwt = false

# stripe-checkout: Validates JWT internally via supabase.auth.getUser()
[functions.stripe-checkout]
verify_jwt = false

# stripe-webhook: Public - Stripe sends webhooks without a user JWT
[functions.stripe-webhook]
verify_jwt = false

# get-plan-exercises: Validates JWT internally via supabase.auth.getUser()
[functions.get-plan-exercises]
verify_jwt = false

# consume-telehealth-credit: Validates JWT internally via supabase.auth.getUser()
[functions.consume-telehealth-credit]
verify_jwt = false
